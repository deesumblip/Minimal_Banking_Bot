<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 5 Tutorial</title>
    
<style>
.markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    word-wrap: break-word;
    color: #24292e;
    background-color: #ffffff;
}

@media (max-width: 767px) {
    .markdown-body {
        padding: 15px;
    }
}

.markdown-body h1,
.markdown-body h2 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
    color: #24292e;
    border-bottom: 1px solid #eaecef;
    padding-bottom: .3em;
}

.markdown-body h1 { font-size: 2em; }
.markdown-body h2 { font-size: 1.5em; }
.markdown-body h3 { font-size: 1.25em; margin-top: 24px; margin-bottom: 16px; }
.markdown-body h4 { font-size: 1em; margin-top: 24px; margin-bottom: 16px; }

.markdown-body p {
    margin-top: 0;
    margin-bottom: 16px;
}

.markdown-body ul,
.markdown-body ol {
    margin-top: 0;
    margin-bottom: 16px;
    padding-left: 2em;
}

.markdown-body li {
    margin-top: .25em;
}

.markdown-body code {
    padding: .2em .4em;
    margin: 0;
    font-size: 85%;
    background-color: rgba(27,31,35,.05);
    border-radius: 3px;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f6f8fa;
    border-radius: 6px;
    margin-bottom: 16px;
}

.markdown-body pre code {
    display: inline;
    padding: 0;
    margin: 0;
    background-color: transparent;
    border: 0;
}

.markdown-body blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: .25em solid #dfe2e5;
    margin: 0 0 16px 0;
}

.markdown-body table {
    border-spacing: 0;
    border-collapse: collapse;
    margin-top: 0;
    margin-bottom: 16px;
    width: 100%;
    display: block;
    overflow: auto;
}

.markdown-body table th {
    font-weight: 600;
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
    background-color: #f6f8fa;
}

.markdown-body table td {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
}

.markdown-body table tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
    background-color: #f6f8fa;
}

.markdown-body hr {
    height: .25em;
    padding: 0;
    margin: 24px 0;
    background-color: #e1e4e8;
    border: 0;
}

.markdown-body a {
    color: #0366d6;
    text-decoration: none;
}

.markdown-body a:hover {
    text-decoration: underline;
}

@media print {
    .markdown-body {
        max-width: 100%;
        padding: 20px;
    }
    
    .markdown-body h1,
    .markdown-body h2 {
        page-break-after: avoid;
    }
    
    .markdown-body pre,
    .markdown-body blockquote {
        page-break-inside: avoid;
    }
}
</style>

</head>
<body>
    <article class="markdown-body">
<h1>Level 5: Tool Calling - Comprehensive Tutorial</h1>
<p><strong>A Complete Guide to Dynamic Function Selection</strong></p>
<hr />
<h2>Table of Contents</h2>
<ol start="0">
<li><a href="#module-0-recap-what-you-built-in-level-4">Recap: What You Built in Level 4</a></li>
<li><a href="#module-1-introduction-to-tools">Introduction to Tools</a></li>
<li><a href="#module-2-understanding-tools-vs-actions">Understanding Tools vs. Actions</a></li>
<li><a href="#module-3-creating-tool-functions">Creating Tool Functions</a></li>
<li><a href="#module-4-registering-tools">Registering Tools</a></li>
<li><a href="#module-5-using-tools-in-conversations">Using Tools in Conversations</a></li>
<li><a href="#module-6-training-and-testing-with-tools">Training and Testing with Tools</a></li>
<li><a href="#module-7-putting-it-all-together">Putting It All Together</a></li>
<li><a href="#module-8-assessment-and-next-steps">Assessment and Next Steps</a></li>
</ol>
<hr />
<h2>Module 0: Recap - What You Built in Level 4</h2>
<h3>0.1 Your Level 4 Banking Bot</h3>
<p>Before we add tool calling, let's recap what you've already built in Level 4. <strong>All of this remains unchanged</strong> - Level 5 builds on top of it!</p>
<h4>What You Have from Level 4</h4>
<p><strong>Domain File (<code>domain/basics.yml</code>)</strong>:<br />
- ✅ All Level 1-3 responses<br />
- ✅ All ask responses: <code>utter_ask_account</code>, <code>utter_ask_amount</code>, <code>utter_ask_recipient</code>, <code>utter_ask_account_from</code><br />
- ✅ All slots: <code>account</code>, <code>amount</code>, <code>recipient</code>, <code>account_from</code><br />
- ✅ All Level 1-3 actions<br />
- ✅ <code>action_process_transfer</code> action (Level 4)</p>
<p><strong>Flows (<code>data/basics/</code>)</strong>:<br />
- ✅ All Level 1-3 flows<br />
- ✅ <code>transfer_money</code> flow with multiple slot collection (Level 4)</p>
<p><strong>Actions (<code>actions/</code>)</strong>:<br />
- ✅ All Level 1-3 actions<br />
- ✅ <code>action_process_transfer</code> that uses multiple slots</p>
<p><strong>System Patterns</strong>: Unchanged from Level 1</p>
<p><strong>Configuration Files</strong>: Unchanged from Level 4</p>
<h4>What Level 4 Couldn't Do</h4>
<p>Your Level 4 bot could collect multiple pieces of information, but it couldn't:<br />
- ❌ Let the LLM dynamically choose which operations to perform<br />
- ❌ Adapt to complex, branching scenarios<br />
- ❌ Handle flexible operations that vary based on context<br />
- ❌ Allow the LLM to decide which functions to call</p>
<p><strong>Example</strong>: If a user asked complex questions like "Check my balance and then transfer $50 if I have enough", your Level 4 bot would need explicit flows for every scenario. It couldn't let the LLM decide to call <code>check_balance</code> first, then conditionally call <code>process_transfer</code>.</p>
<hr />
<h3>0.2 What Level 5 Adds</h3>
<p>Level 5 introduces <strong>Tool Calling</strong> - allowing the LLM to dynamically select and call functions based on conversation context.</p>
<p><strong>Your existing Level 4 bot continues to work</strong> - Level 5 adds dynamic tool calling on top of it!</p>
<h4>What's New in Level 5</h4>
<p><strong>New Files</strong>:<br />
- <code>tools/</code> folder - Contains tool functions<br />
- <code>tools/__init__.py</code> - Makes the folder a Python package<br />
- <code>tools/banking_tools.py</code> - Contains tool functions the LLM can call</p>
<p><strong>Modified Files</strong>:<br />
- <code>endpoints.yml</code> - Adds <code>tools:</code> section to register tools<br />
- New action: <code>action_process_transfer_with_tools.py</code> - Demonstrates tools usage<br />
- New flow: <code>transfer_money_tools.yml</code> - Flow that uses tool calling</p>
<p><strong>Unchanged</strong>:<br />
- All Level 1-4 responses remain<br />
- All Level 1-4 flows remain<br />
- All Level 1-4 actions remain<br />
- All Level 1-4 slots remain</p>
<hr />
<h2>Module 1: Introduction to Tools</h2>
<h3>1.1 What is a Tool?</h3>
<p>A <strong>tool</strong> is a Python function that the LLM can dynamically call during conversations. Unlike actions (which are explicitly called in flows), tools are selected by the LLM based on the conversation context.</p>
<h4>Tools vs. Actions</h4>
<p><strong>Actions (<code>action_*</code>)</strong>:<br />
- Explicitly called in flows: <code>- action: action_name</code><br />
- Predictable execution order<br />
- You control exactly when they run<br />
- Good for: Structured workflows, required steps</p>
<p><strong>Tools</strong>:<br />
- Dynamically selected by the LLM<br />
- Called based on conversation context<br />
- LLM decides when to call them<br />
- Good for: Flexible operations, complex multi-step tasks, adapting to user needs</p>
<h4>Example: Checking Balance</h4>
<p><strong>With Actions (Level 2-4)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Explicit flow</span>
<span class="nt">steps</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_check_balance</span>
</code></pre></div>

<p><strong>With Tools (Level 5)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># LLM decides to call check_balance tool based on conversation</span>
<span class="c1"># No explicit flow step needed - LLM chooses dynamically</span>
</code></pre></div>

<hr />
<h3>1.2 When to Use Tools</h3>
<p>✅ <strong>Use tools when</strong>:<br />
- You want the LLM to decide what to do<br />
- Operations might vary based on context<br />
- Complex, multi-step scenarios with branching<br />
- Flexible operations that adapt to user needs</p>
<p>❌ <strong>Use actions when</strong>:<br />
- You need guaranteed execution order<br />
- Predictable, structured workflows<br />
- Simple, single-purpose operations<br />
- You want explicit control over when code runs</p>
<h4>Example Scenarios</h4>
<p><strong>Good for Tools</strong>:<br />
- "Check my balance and transfer $50 if I have enough" → LLM decides to call <code>check_balance</code>, then conditionally call <code>process_transfer</code><br />
- "What's my account info and balance?" → LLM calls <code>get_account_info</code> and <code>check_balance</code><br />
- Complex queries that require multiple operations</p>
<p><strong>Good for Actions</strong>:<br />
- "What are your hours?" → Simple, predictable → Use action<br />
- "Transfer $100 to John" → Structured workflow → Use action (or tool, both work)</p>
<hr />
<h3>1.3 How Tools Work</h3>
<p>When tools are available, the LLM:</p>
<ol>
<li><strong>Analyzes the conversation</strong> - Understands what the user wants</li>
<li><strong>Selects appropriate tools</strong> - Decides which tools to call</li>
<li><strong>Calls tools dynamically</strong> - Executes the selected tools</li>
<li><strong>Uses results</strong> - Incorporates tool results into the response</li>
</ol>
<p><strong>Key Point</strong>: You don't explicitly call tools in flows - the LLM decides when to use them based on context.</p>
<hr />
<h2>Module 2: Understanding Tools vs. Actions</h2>
<h3>2.1 Key Differences</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Actions</th>
<th>Tools</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Definition</strong></td>
<td>Python classes in <code>actions/</code></td>
<td>Python functions in <code>tools/</code></td>
</tr>
<tr>
<td><strong>Registration</strong></td>
<td>In <code>domain/basics.yml</code> under <code>actions:</code></td>
<td>In <code>endpoints.yml</code> under <code>tools:</code></td>
</tr>
<tr>
<td><strong>Calling</strong></td>
<td>Explicit in flows: <code>- action: action_name</code></td>
<td>Dynamic by LLM (no explicit call)</td>
</tr>
<tr>
<td><strong>Control</strong></td>
<td>You control when they run</td>
<td>LLM decides when to call</td>
</tr>
<tr>
<td><strong>Use Case</strong></td>
<td>Structured, predictable workflows</td>
<td>Flexible, context-aware operations</td>
</tr>
</tbody>
</table>
<hr />
<h3>2.2 When to Use Each</h3>
<h4>Use Actions For:</h4>
<ul>
<li><strong>Structured workflows</strong>: "Transfer money" → Collect slots → Process transfer</li>
<li><strong>Required steps</strong>: Steps that must always happen in a specific order</li>
<li><strong>Simple operations</strong>: Single-purpose, straightforward tasks</li>
<li><strong>Explicit control</strong>: When you need to guarantee execution</li>
</ul>
<p><strong>Example</strong>: The <code>transfer_money</code> flow uses actions because it's a structured process: collect information → process transfer.</p>
<h4>Use Tools For:</h4>
<ul>
<li><strong>Flexible operations</strong>: "Check balance and transfer if possible"</li>
<li><strong>Complex scenarios</strong>: Multi-step tasks with branching</li>
<li><strong>Context-dependent</strong>: Operations that vary based on conversation</li>
<li><strong>LLM decision-making</strong>: When you want the LLM to choose what to do</li>
</ul>
<p><strong>Example</strong>: The <code>transfer_money_tools</code> flow uses tools because the LLM can dynamically decide which operations to perform.</p>
<hr />
<h3>2.3 Can You Use Both?</h3>
<p><strong>Yes!</strong> You can use both actions and tools in the same bot:</p>
<ul>
<li><strong>Actions</strong> for structured, predictable workflows</li>
<li><strong>Tools</strong> for flexible, dynamic operations</li>
</ul>
<p>They complement each other - use the right tool for the right job.</p>
<hr />
<h2>Module 3: Creating Tool Functions</h2>
<h3>3.1 Tool Function Structure</h3>
<p>Tools are simple Python functions (not classes like actions). Here's the basic structure:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">tool_name</span><span class="p">(</span><span class="n">param1</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">param2</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tool description.</span>

<span class="sd">    Args:</span>
<span class="sd">        param1: Description of param1</span>
<span class="sd">        param2: Description of param2</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Your logic here</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">}</span>
</code></pre></div>

<p><strong>Key Requirements</strong>:<br />
1. Function must have a docstring (LLM uses this to understand the tool)<br />
2. Parameters should be typed<br />
3. Should return a dictionary<br />
4. Must be exported in <code>__all__</code> list</p>
<hr />
<h3>3.2 Examining Banking Tools</h3>
<p>Let's look at the actual <code>banking_tools.py</code> file:</p>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Banking tools for Level 5: Tool Calling.</span>

<span class="sd">Tools are functions that the LLM can dynamically call during conversations.</span>
<span class="sd">Unlike actions (which are explicitly called in flows), tools are selected</span>
<span class="sd">by the LLM based on the conversation context.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>


<span class="k">def</span> <span class="nf">check_balance</span><span class="p">(</span><span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the balance for a given account.</span>

<span class="sd">    This is a tool function that the LLM can call dynamically.</span>

<span class="sd">    Args:</span>
<span class="sd">        account: The account number to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with the balance information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Demo implementation - in real life, this would query a database</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;account&quot;</span><span class="p">:</span> <span class="n">account</span><span class="p">,</span>
        <span class="s2">&quot;balance&quot;</span><span class="p">:</span> <span class="mf">1234.56</span><span class="p">,</span>
        <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="s2">&quot;USD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span>
    <span class="p">}</span>


<span class="k">def</span> <span class="nf">process_transfer</span><span class="p">(</span><span class="n">amount</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">from_account</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">to_account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a money transfer between accounts.</span>

<span class="sd">    This is a tool function that the LLM can call dynamically.</span>

<span class="sd">    Args:</span>
<span class="sd">        amount: The amount to transfer</span>
<span class="sd">        from_account: Source account number</span>
<span class="sd">        to_account: Destination account number</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with the transfer result</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Demo implementation - in real life, this would process a real transfer</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;transaction_id&quot;</span><span class="p">:</span> <span class="s2">&quot;TXN-12345&quot;</span><span class="p">,</span>
        <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
        <span class="s2">&quot;from_account&quot;</span><span class="p">:</span> <span class="n">from_account</span><span class="p">,</span>
        <span class="s2">&quot;to_account&quot;</span><span class="p">:</span> <span class="n">to_account</span><span class="p">,</span>
        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Transfer processed successfully&quot;</span>
    <span class="p">}</span>


<span class="k">def</span> <span class="nf">get_account_info</span><span class="p">(</span><span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get information about an account.</span>

<span class="sd">    This is a tool function that the LLM can call dynamically.</span>

<span class="sd">    Args:</span>
<span class="sd">        account: The account number</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with account information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Demo implementation</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;account&quot;</span><span class="p">:</span> <span class="n">account</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;checking&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;opened&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-01-15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span>
    <span class="p">}</span>


<span class="c1"># Export all tools so Rasa can discover them</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;check_balance&quot;</span><span class="p">,</span> <span class="s2">&quot;process_transfer&quot;</span><span class="p">,</span> <span class="s2">&quot;get_account_info&quot;</span><span class="p">]</span>
</code></pre></div>

<h4>Breaking Down Tool Functions</h4>
<ol>
<li><strong>Docstring</strong>: Critical! The LLM reads this to understand what the tool does<br />
   ```python<br />
   """Check the balance for a given account.</li>
</ol>
<p>Args:<br />
       account: The account number to check<br />
   """<br />
   ```</p>
<ol start="2">
<li>
<p><strong>Type Hints</strong>: Help the LLM understand parameter types<br />
<code>python
   def check_balance(account: str) -&gt; Dict[str, Any]:</code></p>
</li>
<li>
<p><strong>Return Dictionary</strong>: Tools return dictionaries with results<br />
<code>python
   return {
       "account": account,
       "balance": 1234.56,
       "currency": "USD"
   }</code></p>
</li>
<li>
<p><strong>Export List</strong>: Must list all tools in <code>__all__</code><br />
<code>python
   __all__ = ["check_balance", "process_transfer", "get_account_info"]</code></p>
</li>
</ol>
<hr />
<h3>3.3 Step-by-Step: Creating a Tool</h3>
<p><strong>Step 1: Navigate to Tools Folder</strong></p>
<ol>
<li>Go to <code>tools/</code> folder (create it if it doesn't exist)</li>
<li>You should see <code>__init__.py</code> and <code>banking_tools.py</code></li>
</ol>
<hr />
<p><strong>Step 2: Add a New Tool Function</strong></p>
<ol>
<li>Open <code>tools/banking_tools.py</code></li>
<li>Add a new function:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">close_account</span><span class="p">(</span><span class="n">account</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Close an account.</span>

<span class="sd">    This tool closes a bank account.</span>

<span class="sd">    Args:</span>
<span class="sd">        account: The account number to close</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary with the closure result</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Demo implementation</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;account&quot;</span><span class="p">:</span> <span class="n">account</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;closed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Account </span><span class="si">{</span><span class="n">account</span><span class="si">}</span><span class="s2"> has been closed successfully.&quot;</span>
    <span class="p">}</span>
</code></pre></div>

<ol start="3">
<li>Add it to <code>__all__</code>:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;check_balance&quot;</span><span class="p">,</span> <span class="s2">&quot;process_transfer&quot;</span><span class="p">,</span> <span class="s2">&quot;get_account_info&quot;</span><span class="p">,</span> <span class="s2">&quot;close_account&quot;</span><span class="p">]</span>
</code></pre></div>

<hr />
<p><strong>Step 3: Verify Your Tool</strong></p>
<p>Check:<br />
- ✅ Function has a clear docstring<br />
- ✅ Parameters are typed<br />
- ✅ Function returns a dictionary<br />
- ✅ Tool is listed in <code>__all__</code><br />
- ✅ Python syntax is correct</p>
<hr />
<h2>Module 4: Registering Tools</h2>
<h3>4.1 Tools Registration in endpoints.yml</h3>
<p>Tools must be registered in <code>endpoints.yml</code> so Rasa knows where to find them.</p>
<h4>endpoints.yml Structure in Level 5</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">action_endpoint</span><span class="p">:</span>
<span class="w">  </span><span class="nt">actions_module</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;actions&quot;</span>

<span class="nt">nlg</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rephrase</span>
<span class="w">  </span><span class="nt">llm</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini</span>

<span class="c1"># Tools registration - NEW in Level 5</span>
<span class="nt">tools</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tools_module</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tools&quot;</span>

<span class="nt">model_groups</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini</span>
<span class="w">    </span><span class="nt">models</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai</span>
<span class="w">        </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini-2024-07-18</span>
<span class="w">        </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.3</span>
</code></pre></div>

<h4>The Tools Section</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">tools</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tools_module</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tools&quot;</span>
</code></pre></div>

<p><strong>Breaking it down</strong>:<br />
- <strong><code>tools:</code></strong> - Section for tool registration<br />
- <strong><code>tools_module: "tools"</code></strong> - Tells Rasa to look in the <code>tools/</code> folder</p>
<p><strong>How it works</strong>:<br />
1. Rasa looks in the <code>tools/</code> folder<br />
2. Finds Python files (like <code>banking_tools.py</code>)<br />
3. Looks for functions listed in <code>__all__</code><br />
4. Makes them available as tools the LLM can call</p>
<hr />
<h3>4.2 Step-by-Step: Registering Tools</h3>
<p><strong>Step 1: Open endpoints.yml</strong></p>
<ol>
<li>Navigate to <code>endpoints.yml</code> (root of your project)</li>
<li>Open it in your editor</li>
</ol>
<p><strong>What you should see</strong>: Existing configuration from Level 4</p>
<hr />
<p><strong>Step 2: Add Tools Section</strong></p>
<ol>
<li>Find the <code>nlg:</code> section</li>
<li>Add the <code>tools:</code> section after it:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nt">nlg</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rephrase</span>
<span class="w">  </span><span class="nt">llm</span><span class="p">:</span>
<span class="w">    </span><span class="nt">model_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpt-4o-mini</span>

<span class="c1"># Tools registration - NEW in Level 5</span>
<span class="nt">tools</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tools_module</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tools&quot;</span>

<span class="nt">model_groups</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ... existing model groups</span>
</code></pre></div>

<p>⚠️ <strong>Important</strong>:<br />
- <code>tools:</code> is at the same indentation level as <code>nlg:</code> and <code>model_groups:</code><br />
- <code>tools_module: "tools"</code> is indented 2 spaces under <code>tools:</code><br />
- The value <code>"tools"</code> matches your <code>tools/</code> folder name</p>
<hr />
<p><strong>Step 3: Verify Registration</strong></p>
<p>Check:<br />
- ✅ <code>tools:</code> section exists<br />
- ✅ <code>tools_module: "tools"</code> matches your folder name<br />
- ✅ YAML syntax is correct<br />
- ✅ All existing configuration remains unchanged</p>
<hr />
<h2>Module 5: Using Tools in Conversations</h2>
<h3>5.1 How Tools Are Called</h3>
<p>Tools are called <strong>dynamically by the LLM</strong> - you don't explicitly call them in flows like actions.</p>
<h4>Tool Calling Process</h4>
<div class="codehilite"><pre><span></span><code><span class="n">User</span><span class="w"> </span><span class="n">sends</span><span class="w"> </span><span class="n">message</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">LLM</span><span class="w"> </span><span class="n">analyzes</span><span class="w"> </span><span class="n">conversation</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">LLM</span><span class="w"> </span><span class="n">reads</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">tools</span><span class="o">/</span><span class="w"> </span><span class="n">folder</span><span class="p">)</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">LLM</span><span class="w"> </span><span class="n">decides</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">context</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">LLM</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="n">tools</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">Tool</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">execute</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">LLM</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="k">tool</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">response</span>
<span class="w">    </span><span class="err">↓</span>
<span class="n">Bot</span><span class="w"> </span><span class="n">responds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">user</span>
</code></pre></div>

<p><strong>Key Point</strong>: The LLM makes the decision - you just provide the tools and let the LLM choose when to use them.</p>
<hr />
<h3>5.2 Creating a Flow That Uses Tools</h3>
<p>While tools are called dynamically, you can create flows that set up the context for tool calling.</p>
<h4>Example: transfer_money_tools Flow</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">transfer_money_tools</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">transfer money with tools</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">Demonstrates tool calling in a flow.</span>
<span class="w">      </span><span class="no">The bot collects the necessary information, then the LLM</span>
<span class="w">      </span><span class="no">can dynamically decide to call tools (like check_balance</span>
<span class="w">      </span><span class="no">or process_transfer) based on the conversation context.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">collect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amount</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;transfer</span><span class="nv"> </span><span class="s">amount&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">collect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recipient</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;recipient</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">account&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">collect</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account_from</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;source</span><span class="nv"> </span><span class="s">account</span><span class="nv"> </span><span class="s">number&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_process_transfer_with_tools</span>
<span class="w">      </span><span class="c1"># Note: Tools are registered in endpoints.yml and can be called</span>
<span class="w">      </span><span class="c1"># dynamically by the LLM during the conversation</span>
</code></pre></div>

<p><strong>What happens</strong>:<br />
1. Flow collects slots (amount, recipient, account_from)<br />
2. Flow calls <code>action_process_transfer_with_tools</code><br />
3. During the conversation, the LLM can dynamically call tools<br />
4. Tools execute and provide results<br />
5. LLM uses tool results in the response</p>
<hr />
<h3>5.3 Tools in Action Code</h3>
<p>Actions can work alongside tools. The LLM can call tools during the conversation, and actions can be aware of tool availability.</p>
<h4>Example: action_process_transfer_with_tools</h4>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ActionProcessTransferWithTools</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A custom action that works with tools.</span>

<span class="sd">    This demonstrates how actions can work alongside tool calling.</span>
<span class="sd">    The LLM can dynamically decide to call tools (like check_balance</span>
<span class="sd">    or process_transfer) based on the conversation context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;action_process_transfer_with_tools&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dispatcher</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
        <span class="c1"># This action can work with tools registered in endpoints.yml</span>
        <span class="c1"># The LLM will decide when to call tools based on the conversation</span>

        <span class="n">amount</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">get_slot</span><span class="p">(</span><span class="s2">&quot;amount&quot;</span><span class="p">)</span>
        <span class="n">recipient</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">get_slot</span><span class="p">(</span><span class="s2">&quot;recipient&quot;</span><span class="p">)</span>
        <span class="n">account_from</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">get_slot</span><span class="p">(</span><span class="s2">&quot;account_from&quot;</span><span class="p">)</span>

        <span class="c1"># Validate slots (same as Level 4)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">amount</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">recipient</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">account_from</span><span class="p">:</span>
            <span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;I&#39;m missing some information. Please provide amount, recipient, and source account.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="c1"># The LLM can call tools dynamically during the conversation</span>
        <span class="c1"># Tools like check_balance, process_transfer, get_account_info</span>
        <span class="c1"># are available and the LLM can choose to use them</span>

        <span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(Demo with Tools) Transfer of $</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s2"> from account </span><span class="si">{</span><span class="n">account_from</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">recipient</span><span class="si">}</span><span class="s2"> has been processed successfully. Tools are available for dynamic operations.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>

<p><strong>Key Point</strong>: The action doesn't explicitly call tools - it just indicates that tools are available, and the LLM decides when to use them.</p>
<hr />
<h2>Module 6: Training and Testing with Tools</h2>
<h3>6.1 Training with Tools</h3>
<p>Training with tools is similar to previous levels, but Rasa now also processes tool definitions.</p>
<h4>Training Command</h4>
<div class="codehilite"><pre><span></span><code><span class="p">.</span> <span class="p">.\</span><span class="n">load_env</span><span class="p">.</span><span class="n">ps1</span>
<span class="n">python</span> <span class="n">-m</span> <span class="n">rasa</span> <span class="n">train</span>
</code></pre></div>

<h4>What Happens During Training</h4>
<p>Rasa:<br />
1. Reads tool definitions from <code>tools/</code> folder<br />
2. Validates tool functions (checks <code>__all__</code> list)<br />
3. Processes tool registration in <code>endpoints.yml</code><br />
4. Makes tools available to the LLM<br />
5. Creates model with tool information</p>
<hr />
<h3>6.2 Testing Tool Calling</h3>
<h4>Basic Testing Workflow</h4>
<ol>
<li>
<p><strong>Train your bot</strong>: <code>python -m rasa train</code></p>
</li>
<li>
<p><strong>Start Inspector</strong>: <br />
<code>powershell
   python -m rasa inspect --debug --log-file logs/logs.out</code></p>
</li>
<li>
<p><strong>Test tool calling</strong>:<br />
   - Type "Transfer $100 to John from account 1234"<br />
   - Bot should collect slots<br />
   - LLM may call tools dynamically based on context<br />
   - Bot should process transfer</p>
</li>
<li>
<p><strong>Test with complex queries</strong>:<br />
   - Type "Check my balance for account 1234 and get account info"<br />
   - LLM should decide to call <code>check_balance</code> and <code>get_account_info</code> tools<br />
   - Bot should provide results from both tools</p>
</li>
<li>
<p><strong>Verify previous levels still work</strong>:<br />
   - All Level 1-4 functionality should still work<br />
   - Tools add new capabilities without breaking existing ones</p>
</li>
</ol>
<hr />
<h3>6.3 Understanding Tool Execution</h3>
<p>In Inspector debug panel, you can see:<br />
- Which tools the LLM decided to call<br />
- Tool execution results<br />
- How the LLM used tool results in the response</p>
<p><strong>Key Point</strong>: Tool calling is dynamic - the LLM makes decisions based on conversation context.</p>
<hr />
<h3>6.4 Common Issues with Tools</h3>
<h4>Issue: Tools Not Found</h4>
<p><strong>Symptoms</strong>: LLM doesn't call tools, or error about tools not found</p>
<p><strong>Possible Causes</strong>:<br />
1. Tools not registered in <code>endpoints.yml</code><br />
2. Tools not exported in <code>__all__</code><br />
3. Tool functions have syntax errors</p>
<p><strong>Solutions</strong>:<br />
1. Check <code>endpoints.yml</code> has <code>tools:</code> section with <code>tools_module: "tools"</code><br />
2. Verify all tools are listed in <code>__all__</code><br />
3. Check Python syntax in tool functions</p>
<hr />
<h4>Issue: LLM Not Calling Tools</h4>
<p><strong>Symptoms</strong>: Tools are registered but LLM never calls them</p>
<p><strong>Possible Causes</strong>:<br />
1. Tool docstrings not clear enough<br />
2. Conversation context doesn't trigger tool usage<br />
3. Tools not appropriate for the use case</p>
<p><strong>Solutions</strong>:<br />
1. Improve tool docstrings (LLM uses these to understand tools)<br />
2. Test with queries that clearly need the tools<br />
3. Consider if actions might be more appropriate</p>
<hr />
<h2>Module 7: Putting It All Together</h2>
<h3>7.1 Complete Bot Walkthrough</h3>
<p>Let's trace through a complete conversation showing how all levels work together, including tool calling.</p>
<h4>Conversation Example</h4>
<div class="codehilite"><pre><span></span><code><span class="k">[User opens chat - new session starts]</span>

<span class="na">1. pattern_session_start triggers (Level 1)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Hi! I&#39;m a banking assistant. How can I help you today?&quot;</span>

<span class="k">[User types: &quot;Check my balance for account 1234 and get the account info&quot;]</span>

<span class="na">2. LLM understands</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;User wants balance and account info&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">LLM sees available tools</span><span class="o">:</span><span class="w"> </span><span class="s">check_balance, get_account_info</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">LLM decides to call both tools dynamically</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Tool</span><span class="o">:</span><span class="w"> </span><span class="s">check_balance(&quot;1234&quot;) executes</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Tool</span><span class="o">:</span><span class="w"> </span><span class="s">get_account_info(&quot;1234&quot;) executes</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">LLM uses tool results in response</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Balance for account 1234 is $1234.56. Account type: checking, Owner: John Doe, Status: active.&quot;</span>

<span class="k">[User types: &quot;Transfer $100 to John from account 1234&quot;]</span>

<span class="na">3. LLM understands</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;User wants to transfer money&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow</span><span class="o">:</span><span class="w"> </span><span class="s">transfer_money_tools (Level 5)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow collects slots</span><span class="o">:</span><span class="w"> </span><span class="s">amount=&quot;100&quot;, recipient=&quot;John&quot;, account_from=&quot;1234&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow calls</span><span class="o">:</span><span class="w"> </span><span class="s">action_process_transfer_with_tools</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">During conversation, LLM may call process_transfer tool dynamically</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;(Demo with Tools) Transfer of $100 from account 1234 to John has been processed successfully. Tools are available for dynamic operations.&quot;</span>

<span class="k">[User types: &quot;What are your hours?&quot;]</span>

<span class="na">4. LLM understands</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;User wants bank hours&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow</span><span class="o">:</span><span class="w"> </span><span class="s">hours (Level 2)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Action</span><span class="o">:</span><span class="w"> </span><span class="s">action_bank_hours</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Our bank hours are Monday-Friday 9am-5pm...&quot;</span>
</code></pre></div>

<p><strong>Notice</strong>: The bot seamlessly uses:<br />
- Level 1 responses<br />
- Level 2 actions<br />
- Level 3 single slot collection<br />
- Level 4 multiple slot collection<br />
- Level 5 tool calling (dynamic function selection)</p>
<hr />
<h3>7.2 Your Level 5 Banking Bot: Summary</h3>
<p>Congratulations! You've completed all five levels and built a comprehensive banking bot!</p>
<h4>Your Complete Bot Structure</h4>
<p><strong>Domain (<code>domain/basics.yml</code>)</strong>:<br />
- ✅ All responses from Levels 1-4<br />
- ✅ All slots from Levels 3-4<br />
- ✅ All actions from Levels 2-4</p>
<p><strong>Flows (<code>data/basics/</code>)</strong>:<br />
- ✅ All flows from Levels 1-4<br />
- ✅ New <code>transfer_money_tools</code> flow (Level 5)</p>
<p><strong>Actions (<code>actions/</code>)</strong>:<br />
- ✅ All actions from Levels 2-4<br />
- ✅ New <code>action_process_transfer_with_tools</code> (Level 5)</p>
<p><strong>Tools (<code>tools/</code>)</strong>:<br />
- ✅ <code>banking_tools.py</code> with tool functions (Level 5)</p>
<p><strong>Configuration</strong>:<br />
- ✅ <code>endpoints.yml</code> with tools registration (Level 5)</p>
<h4>What Your Bot Can Do Now</h4>
<p>Your Level 5 banking bot can:<br />
- ✅ Everything from Levels 1-4<br />
- ✅ Dynamically call functions based on conversation context<br />
- ✅ Handle complex, branching scenarios<br />
- ✅ Adapt to user needs flexibly<br />
- ✅ Use LLM decision-making for tool selection</p>
<h4>Complete Capabilities</h4>
<ul>
<li><strong>Level 1</strong>: Static responses</li>
<li><strong>Level 2</strong>: Custom Python code (actions)</li>
<li><strong>Level 3</strong>: Memory (single slots)</li>
<li><strong>Level 4</strong>: Multiple slot collection</li>
<li><strong>Level 5</strong>: Dynamic tool calling</li>
</ul>
<p>You now have a fully-featured conversational banking bot!</p>
<hr />
<h3>7.3 Best Practices</h3>
<h4>Tool Design</h4>
<ol>
<li><strong>Clear docstrings</strong>: LLM uses these to understand tools - make them descriptive</li>
<li><strong>Type hints</strong>: Help LLM understand parameter types</li>
<li><strong>Return dictionaries</strong>: Tools should return structured data</li>
<li><strong>Export in <strong>all</strong></strong>: Must list all tools for Rasa to discover them</li>
</ol>
<h4>When to Use Tools vs. Actions</h4>
<p><strong>Use Tools</strong>:<br />
- When you want LLM to decide what to do<br />
- For flexible, context-aware operations<br />
- Complex scenarios with branching</p>
<p><strong>Use Actions</strong>:<br />
- For structured, predictable workflows<br />
- When you need guaranteed execution order<br />
- Simple, single-purpose operations</p>
<h4>Tool Documentation</h4>
<p><strong>Good tool docstring</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Check the balance for a given account.</span>

<span class="sd">This tool retrieves the current balance for a bank account.</span>

<span class="sd">Args:</span>
<span class="sd">    account: The account number to check (e.g., &quot;1234&quot;)</span>

<span class="sd">Returns:</span>
<span class="sd">    A dictionary with:</span>
<span class="sd">        - account: The account number</span>
<span class="sd">        - balance: The current balance</span>
<span class="sd">        - currency: The currency code</span>
<span class="sd">        - status: Account status</span>
<span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>

<p><strong>Bad tool docstring</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Check balance.&quot;&quot;&quot;</span>  <span class="c1"># Too vague - LLM won&#39;t understand when to use it</span>
</code></pre></div>

<hr />
<h2>Module 8: Assessment and Next Steps</h2>
<h3>8.1 Knowledge Check</h3>
<h4>Question 1: What is a Tool?</h4>
<p>a) A predefined bot message<br />
b) A Python function the LLM can call dynamically<br />
c) A memory variable<br />
d) A conversation script</p>
<p><strong>Answer</strong>: b) A Python function the LLM can call dynamically</p>
<p><strong>Explanation</strong>: Tools are Python functions that the LLM can select and call based on conversation context, unlike actions which are explicitly called in flows.</p>
<hr />
<h4>Question 2: Where are Tools Registered?</h4>
<p>a) In <code>domain/basics.yml</code> under <code>tools:</code><br />
b) In <code>endpoints.yml</code> under <code>tools:</code><br />
c) In flow files<br />
d) In action files</p>
<p><strong>Answer</strong>: b) In <code>endpoints.yml</code> under <code>tools:</code></p>
<p><strong>Explanation</strong>: Tools are registered in <code>endpoints.yml</code> with <code>tools_module: "tools"</code>, which tells Rasa where to find tool functions.</p>
<hr />
<h4>Question 3: How Does the LLM Know When to Call Tools?</h4>
<p>a) Tools are explicitly called in flows<br />
b) The LLM reads tool docstrings and decides based on context<br />
c) Tools are called automatically<br />
d) You must specify when to call tools</p>
<p><strong>Answer</strong>: b) The LLM reads tool docstrings and decides based on context</p>
<p><strong>Explanation</strong>: The LLM analyzes the conversation, reads available tool docstrings, and dynamically decides which tools to call based on what the user needs.</p>
<hr />
<h4>Question 4: What's the Main Difference Between Tools and Actions?</h4>
<p>a) Tools are in Python, actions are in YAML<br />
b) Tools are called dynamically by LLM, actions are called explicitly in flows<br />
c) Tools are faster than actions<br />
d) There's no difference</p>
<p><strong>Answer</strong>: b) Tools are called dynamically by LLM, actions are called explicitly in flows</p>
<p><strong>Explanation</strong>: Actions are explicitly called in flows with <code>- action: action_name</code>, while tools are dynamically selected by the LLM based on conversation context.</p>
<hr />
<h3>8.2 What You've Learned</h3>
<h4>Key Concepts</h4>
<ol>
<li><strong>Tools</strong>: Python functions the LLM can call dynamically</li>
<li><strong>Tool Registration</strong>: Telling Rasa where to find tools in <code>endpoints.yml</code></li>
<li><strong>Dynamic Selection</strong>: LLM decides which tools to call based on context</li>
<li><strong>Tools vs. Actions</strong>: When to use each approach</li>
</ol>
<h4>Skills You've Developed</h4>
<ul>
<li>✅ Can create tool functions</li>
<li>✅ Can register tools in endpoints.yml</li>
<li>✅ Can understand when to use tools vs. actions</li>
<li>✅ Can build bots with dynamic tool calling</li>
<li>✅ Can create comprehensive, flexible conversational interfaces</li>
</ul>
<hr />
<h3>8.3 Course Completion</h3>
<p>Congratulations! You've completed all five levels of the Rasa Pro + CALM tutorial!</p>
<h4>What You've Built</h4>
<p>You now have a complete banking bot that can:<br />
- ✅ Provide static information (Level 1)<br />
- ✅ Execute custom Python code (Level 2)<br />
- ✅ Remember information (Level 3)<br />
- ✅ Collect multiple pieces of information (Level 4)<br />
- ✅ Dynamically call functions based on context (Level 5)</p>
<h4>Your Complete Learning Journey</h4>
<ul>
<li><strong>Level 1</strong>: Responses - Predefined bot messages</li>
<li><strong>Level 2</strong>: Actions - Custom Python code</li>
<li><strong>Level 3</strong>: Slots - Conversation memory</li>
<li><strong>Level 4</strong>: Multiple Slots - Complex data collection</li>
<li><strong>Level 5</strong>: Tools - Dynamic function selection</li>
</ul>
<hr />
<h3>8.4 Next Steps</h3>
<h4>Continue Learning</h4>
<ul>
<li><strong>Advanced Rasa Features</strong>: Explore more advanced Rasa Pro capabilities</li>
<li><strong>Custom Integrations</strong>: Integrate with databases, APIs, external services</li>
<li><strong>Production Deployment</strong>: Learn how to deploy your bot to production</li>
<li><strong>Testing Strategies</strong>: Learn comprehensive testing approaches</li>
<li><strong>Performance Optimization</strong>: Optimize your bot for scale</li>
</ul>
<h4>Practice Projects</h4>
<ul>
<li>Build bots for different domains (customer service, e-commerce, etc.)</li>
<li>Integrate with real APIs and databases</li>
<li>Add more sophisticated validation and error handling</li>
<li>Experiment with different tool and action patterns</li>
</ul>
<h4>Resources</h4>
<ul>
<li>Rasa Documentation: <a href="https://rasa.com/docs">https://rasa.com/docs</a></li>
<li>Rasa Community: Join forums and discussions</li>
<li>Rasa Examples: Explore example bots and patterns</li>
<li>Rasa Training: Advanced training courses</li>
</ul>
<hr />
<h3>8.5 Final Checklist</h3>
<p>You've mastered Rasa Pro + CALM fundamentals if you can:</p>
<ul>
<li>[ ] Build bots with responses, actions, slots, and tools</li>
<li>[ ] Understand when to use each approach</li>
<li>[ ] Create flows that collect information</li>
<li>[ ] Write actions that use slots</li>
<li>[ ] Create tools for dynamic operations</li>
<li>[ ] Debug and test your bots effectively</li>
<li>[ ] Understand that each level builds on previous levels</li>
</ul>
<p><strong>You're now ready to build production-ready Rasa bots! 🎉</strong></p>
<hr />
<h2>Troubleshooting Guide</h2>
<h3>Common Issues and Solutions</h3>
<h4>Issue: Tools Not Being Called</h4>
<p><strong>Symptoms</strong>: Tools are registered but LLM never calls them</p>
<p><strong>Possible Causes</strong>:<br />
1. Tool docstrings not descriptive enough<br />
2. Conversation doesn't clearly need the tools<br />
3. Tools not appropriate for the use case</p>
<p><strong>Solutions</strong>:<br />
1. Improve tool docstrings - be very descriptive<br />
2. Test with queries that clearly need the tools<br />
3. Consider if actions might be better for this use case</p>
<hr />
<h4>Issue: Tool Registration Error</h4>
<p><strong>Symptoms</strong>: Error about tools not found or tools_module error</p>
<p><strong>Possible Causes</strong>:<br />
1. <code>tools:</code> section missing in endpoints.yml<br />
2. <code>tools_module</code> value doesn't match folder name<br />
3. Tools not exported in <code>__all__</code></p>
<p><strong>Solutions</strong>:<br />
1. Check <code>endpoints.yml</code> has <code>tools:</code> section<br />
2. Verify <code>tools_module: "tools"</code> matches your folder name<br />
3. Ensure all tools are in <code>__all__</code> list</p>
<hr />
<h2>Conclusion</h2>
<p>Congratulations! You've completed all five levels and have a complete understanding of Rasa Pro + CALM!</p>
<h3>What You Can Do Now</h3>
<ul>
<li>Build comprehensive conversational bots</li>
<li>Use responses, actions, slots, and tools effectively</li>
<li>Create flexible, context-aware conversations</li>
<li>Handle complex multi-step interactions</li>
<li>Deploy production-ready bots</li>
</ul>
<h3>Your Complete Banking Bot</h3>
<p>You've built a banking bot that demonstrates:<br />
- ✅ Static information (Level 1)<br />
- ✅ Dynamic code execution (Level 2)<br />
- ✅ Conversation memory (Level 3)<br />
- ✅ Multiple data collection (Level 4)<br />
- ✅ Dynamic tool calling (Level 5)</p>
<h3>Keep Learning</h3>
<ul>
<li>Practice by building more bots</li>
<li>Experiment with different patterns</li>
<li>Integrate with real systems</li>
<li>Read advanced Rasa documentation</li>
<li>Join the Rasa community</li>
<li>Share your bots and learn from others</li>
</ul>
<p><strong>You're now a Rasa Pro + CALM expert! 🚀</strong></p>
<p><strong>Happy building!</strong></p>
    </article>
</body>
</html>