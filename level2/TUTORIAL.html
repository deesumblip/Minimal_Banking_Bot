<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 2 Tutorial</title>
    
<style>
.markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 980px;
    margin: 0 auto;
    padding: 45px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    word-wrap: break-word;
    color: #24292e;
    background-color: #ffffff;
}

@media (max-width: 767px) {
    .markdown-body {
        padding: 15px;
    }
}

.markdown-body h1,
.markdown-body h2 {
    margin-top: 24px;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.25;
    color: #24292e;
    border-bottom: 1px solid #eaecef;
    padding-bottom: .3em;
}

.markdown-body h1 { font-size: 2em; }
.markdown-body h2 { font-size: 1.5em; }
.markdown-body h3 { font-size: 1.25em; margin-top: 24px; margin-bottom: 16px; }
.markdown-body h4 { font-size: 1em; margin-top: 24px; margin-bottom: 16px; }

.markdown-body p {
    margin-top: 0;
    margin-bottom: 16px;
}

.markdown-body ul,
.markdown-body ol {
    margin-top: 0;
    margin-bottom: 16px;
    padding-left: 2em;
}

.markdown-body li {
    margin-top: .25em;
}

.markdown-body code {
    padding: .2em .4em;
    margin: 0;
    font-size: 85%;
    background-color: rgba(27,31,35,.05);
    border-radius: 3px;
    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f6f8fa;
    border-radius: 6px;
    margin-bottom: 16px;
}

.markdown-body pre code {
    display: inline;
    padding: 0;
    margin: 0;
    background-color: transparent;
    border: 0;
}

.markdown-body blockquote {
    padding: 0 1em;
    color: #6a737d;
    border-left: .25em solid #dfe2e5;
    margin: 0 0 16px 0;
}

.markdown-body table {
    border-spacing: 0;
    border-collapse: collapse;
    margin-top: 0;
    margin-bottom: 16px;
    width: 100%;
    display: block;
    overflow: auto;
}

.markdown-body table th {
    font-weight: 600;
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
    background-color: #f6f8fa;
}

.markdown-body table td {
    padding: 6px 13px;
    border: 1px solid #dfe2e5;
}

.markdown-body table tr {
    background-color: #fff;
    border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
    background-color: #f6f8fa;
}

.markdown-body hr {
    height: .25em;
    padding: 0;
    margin: 24px 0;
    background-color: #e1e4e8;
    border: 0;
}

.markdown-body a {
    color: #0366d6;
    text-decoration: none;
}

.markdown-body a:hover {
    text-decoration: underline;
}

@media print {
    .markdown-body {
        max-width: 100%;
        padding: 20px;
    }
    
    .markdown-body h1,
    .markdown-body h2 {
        page-break-after: avoid;
    }
    
    .markdown-body pre,
    .markdown-body blockquote {
        page-break-inside: avoid;
    }
}
</style>

</head>
<body>
    <article class="markdown-body">
<h1>Level 2: Simple Actions - Comprehensive Tutorial</h1>
<p><strong>A Complete Guide to Adding Custom Python Code to Your Banking Bot</strong></p>
<hr />
<h2>Table of Contents</h2>
<ol start="0">
<li><a href="#module-0-recap-what-you-built-in-level-1">Recap: What You Built in Level 1</a></li>
<li><a href="#module-1-introduction-to-actions">Introduction to Actions</a></li>
<li><a href="#module-2-understanding-the-action-class">Understanding the Action Class</a></li>
<li><a href="#module-3-creating-your-first-action">Creating Your First Action</a></li>
<li><a href="#module-4-registering-actions-in-the-domain">Registering Actions in the Domain</a></li>
<li><a href="#module-5-using-actions-in-flows">Using Actions in Flows</a></li>
<li><a href="#module-6-training-and-testing-with-actions">Training and Testing with Actions</a></li>
<li><a href="#module-7-putting-it-all-together">Putting It All Together</a></li>
<li><a href="#module-8-assessment-and-next-steps">Assessment and Next Steps</a></li>
</ol>
<hr />
<h2>Module 0: Recap - What You Built in Level 1</h2>
<h3>0.1 Your Level 1 Banking Bot</h3>
<p>Before we add actions, let's recap what you've already built in Level 1. <strong>All of this remains unchanged</strong> - Level 2 builds on top of it!</p>
<h4>What You Have from Level 1</h4>
<p><strong>Domain File (<code>domain/basics.yml</code>)</strong>:<br />
- ✅ <code>utter_greet</code> - Greets users as a banking assistant<br />
- ✅ <code>utter_help</code> - Lists banking services (balance, transfers, hours, contact)<br />
- ✅ <code>utter_contact</code> - Provides bank contact information</p>
<p><strong>Flows (<code>data/basics/</code>)</strong>:<br />
- ✅ <code>greet.yml</code> - Greets users when they start a conversation<br />
- ✅ <code>help.yml</code> - Explains what the bot can help with<br />
- ✅ <code>contact.yml</code> - Provides contact information for the bank</p>
<p><strong>System Patterns (<code>data/system/patterns/patterns.yml</code>)</strong>:<br />
- ✅ <code>pattern_session_start</code> - Automatically greets users when conversation begins<br />
- ✅ <code>pattern_completed</code> - Handles flow completion</p>
<p><strong>Configuration Files</strong>:<br />
- ✅ <code>config.yml</code> - Bot configuration (pipeline, policies)<br />
- ✅ <code>credentials.yml</code> - Connection settings<br />
- ✅ <code>endpoints.yml</code> - Action endpoints and LLM configuration</p>
<h4>What Level 1 Couldn't Do</h4>
<p>Your Level 1 bot was limited to <strong>static responses</strong> - predefined text that never changes. It couldn't:<br />
- ❌ Execute custom Python code<br />
- ❌ Perform calculations<br />
- ❌ Access databases or APIs<br />
- ❌ Return dynamic responses based on conditions<br />
- ❌ Process data or make decisions</p>
<p><strong>Example</strong>: If a user asked "What are your bank hours?", your Level 1 bot would need a static <code>utter_hours</code> response. It couldn't check the current day or calculate if the bank is currently open.</p>
<hr />
<h3>0.2 What Level 2 Adds</h3>
<p>Level 2 introduces <strong>Actions</strong> - custom Python code that your bot can execute. This enables:</p>
<ul>
<li>✅ Dynamic responses based on calculations</li>
<li>✅ Data processing and logic</li>
<li>✅ Integration with external systems</li>
<li>✅ Custom business logic</li>
</ul>
<p><strong>Your existing Level 1 bot continues to work</strong> - Level 2 adds actions on top of it!</p>
<h4>What's New in Level 2</h4>
<p><strong>New Files</strong>:<br />
- <code>actions/</code> folder - Contains Python action files<br />
- <code>actions/__init__.py</code> - Makes the folder a Python package<br />
- <code>actions/action_bank_hours.py</code> - Your first custom action</p>
<p><strong>Modified Files</strong>:<br />
- <code>domain/basics.yml</code> - Adds <code>actions:</code> section to register actions<br />
- <code>data/basics/hours.yml</code> - New flow that uses an action instead of a response</p>
<p><strong>Unchanged Files</strong>:<br />
- All Level 1 responses remain<br />
- All Level 1 flows remain<br />
- All configuration files remain (with minor updates to endpoints.yml)</p>
<hr />
<h2>Module 1: Introduction to Actions</h2>
<h3>1.1 What is an Action?</h3>
<p>An <strong>action</strong> is custom Python code that your bot can execute. Actions allow your bot to do more than just say predefined text - they can perform calculations, access databases, call APIs, and execute any Python logic you write.</p>
<h4>Actions vs. Responses</h4>
<p><strong>Responses (<code>utter_*</code>)</strong>:<br />
- Predefined text messages<br />
- No custom logic<br />
- Just sends text to the user<br />
- Defined in <code>domain/basics.yml</code> under <code>responses:</code></p>
<p><strong>Actions (<code>action_*</code>)</strong>:<br />
- Custom Python code<br />
- Can execute any logic<br />
- Can access databases, APIs, perform calculations<br />
- Defined in Python files in <code>actions/</code> folder<br />
- Registered in <code>domain/basics.yml</code> under <code>actions:</code></p>
<h4>When to Use Actions</h4>
<p>✅ <strong>Use actions when you need</strong>:<br />
- Dynamic responses (e.g., "We're open today until 5pm" - changes based on current day)<br />
- Calculations (e.g., calculating interest, fees)<br />
- Data processing (e.g., formatting dates, validating input)<br />
- External integrations (e.g., checking account balance from a database)<br />
- Conditional logic (e.g., different responses based on conditions)</p>
<p>❌ <strong>Don't use actions for</strong>:<br />
- Simple static text (use responses instead)<br />
- Messages that never change<br />
- Text that doesn't require any processing</p>
<h4>Example: Bank Hours</h4>
<p><strong>Level 1 approach</strong> (static response):</p>
<div class="codehilite"><pre><span></span><code><span class="nt">utter_hours</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;We&#39;re</span><span class="nv"> </span><span class="s">open</span><span class="nv"> </span><span class="s">Monday-Friday</span><span class="nv"> </span><span class="s">9am-5pm,</span><span class="nv"> </span><span class="s">Saturday</span><span class="nv"> </span><span class="s">10am-2pm.&quot;</span>
</code></pre></div>

<p><strong>Level 2 approach</strong> (dynamic action):</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dispatcher</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
    <span class="c1"># Check current day</span>
    <span class="c1"># Check if it&#39;s a holiday</span>
    <span class="c1"># Return dynamic message: &quot;We&#39;re open today until 5pm&quot; or &quot;We&#39;re closed today&quot;</span>
</code></pre></div>

<hr />
<h3>1.2 How Actions Work</h3>
<p>When a flow calls an action, here's what happens:</p>
<div class="codehilite"><pre><span></span><code>User sends message: &quot;What are your hours?&quot;
    ↓
Flow: hours is triggered
    ↓
Flow step: - action: action_bank_hours
    ↓
Rasa finds action_bank_hours in actions/ folder
    ↓
Rasa executes the action&#39;s run() method
    ↓
Action executes Python code
    ↓
Action sends message via dispatcher.utter_message()
    ↓
Bot responds with dynamic message
</code></pre></div>

<p><strong>Key Point</strong>: Actions are Python classes that Rasa calls when needed. You write the logic, Rasa handles the execution.</p>
<hr />
<h3>1.3 The Action Class Structure</h3>
<p>Every action is a Python class that inherits from <code>Action</code>. Here's the basic structure:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">rasa_sdk</span> <span class="kn">import</span> <span class="n">Action</span><span class="p">,</span> <span class="n">Tracker</span>
<span class="kn">from</span> <span class="nn">rasa_sdk.executor</span> <span class="kn">import</span> <span class="n">CollectingDispatcher</span>

<span class="k">class</span> <span class="nc">ActionBankHours</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;action_bank_hours&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dispatcher</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
        <span class="c1"># Your custom code here</span>
        <span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span><span class="s2">&quot;Your message here&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>

<p><strong>Required Methods</strong>:<br />
1. <strong><code>name()</code></strong> - Returns the action name (must match what's in domain)<br />
2. <strong><code>run()</code></strong> - Contains your custom logic</p>
<hr />
<h2>Module 2: Understanding the Action Class</h2>
<h3>2.1 The Action Class Deep Dive</h3>
<p>Let's examine the actual <code>action_bank_hours.py</code> file to understand how actions work.</p>
<h4>Complete Action File</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Text</span>

<span class="kn">from</span> <span class="nn">rasa_sdk</span> <span class="kn">import</span> <span class="n">Action</span><span class="p">,</span> <span class="n">Tracker</span>
<span class="kn">from</span> <span class="nn">rasa_sdk.executor</span> <span class="kn">import</span> <span class="n">CollectingDispatcher</span>


<span class="k">class</span> <span class="nc">ActionBankHours</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple custom action that returns bank hours.</span>

<span class="sd">    This action doesn&#39;t use any slots (memory) - it just returns</span>
<span class="sd">    a hardcoded message. Perfect for learning how actions work!</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the name of this action.</span>

<span class="sd">        This name must match what you put in domain/basics.yml</span>
<span class="sd">        under the &#39;actions:&#39; list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;action_bank_hours&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dispatcher</span><span class="p">:</span> <span class="n">CollectingDispatcher</span><span class="p">,</span>
        <span class="n">tracker</span><span class="p">:</span> <span class="n">Tracker</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Text</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Text</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute the action.</span>

<span class="sd">        Args:</span>
<span class="sd">            dispatcher: Used to send messages back to the user</span>
<span class="sd">            tracker: Contains the conversation history and slots</span>
<span class="sd">            domain: The bot&#39;s domain configuration</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of events (usually empty for simple actions)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This is where your custom logic goes!</span>
        <span class="c1"># For now, we just return a hardcoded message.</span>
        <span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Our bank hours are Monday-Friday 9am-5pm, Saturday 10am-2pm. We&#39;re closed on Sundays.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>

<h4>Breaking Down Each Component</h4>
<ol>
<li>
<p><strong>Imports</strong>:<br />
<code>python
   from rasa_sdk import Action, Tracker
   from rasa_sdk.executor import CollectingDispatcher</code><br />
   - <code>Action</code> - Base class all actions inherit from<br />
   - <code>Tracker</code> - Contains conversation history and slots (we'll use this in Level 3)<br />
   - <code>CollectingDispatcher</code> - Used to send messages to the user</p>
</li>
<li>
<p><strong>Class Definition</strong>:<br />
<code>python
   class ActionBankHours(Action):</code><br />
   - Must inherit from <code>Action</code><br />
   - Class name should be descriptive (convention: <code>Action</code> + descriptive name)</p>
</li>
<li>
<p><strong><code>name()</code> Method</strong>:<br />
<code>python
   def name(self) -&gt; Text:
       return "action_bank_hours"</code><br />
   - Returns the action identifier<br />
   - <strong>Must match</strong> what you register in <code>domain/basics.yml</code><br />
   - Convention: starts with <code>action_</code></p>
</li>
<li>
<p><strong><code>run()</code> Method</strong>:<br />
<code>python
   def run(self, dispatcher, tracker, domain):</code><br />
   - <strong><code>dispatcher</code></strong>: Use this to send messages to the user<br />
   - <strong><code>tracker</code></strong>: Access conversation history and slots (Level 3+)<br />
   - <strong><code>domain</code></strong>: Access domain configuration (rarely needed)<br />
   - <strong>Returns</strong>: List of events (usually empty <code>[]</code> for simple actions)</p>
</li>
<li>
<p><strong>Sending Messages</strong>:<br />
<code>python
   dispatcher.utter_message(text="Your message here")</code><br />
   - This is how you send text to the user<br />
   - Can also use <code>dispatcher.utter_message(response="utter_xyz")</code> to use a response</p>
</li>
</ol>
<hr />
<h3>2.2 Understanding the Parameters</h3>
<h4>Dispatcher</h4>
<p>The <code>dispatcher</code> is your way to communicate with the user:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Send a simple text message</span>
<span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span>

<span class="c1"># Use a response from the domain</span>
<span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span><span class="n">response</span><span class="o">=</span><span class="s2">&quot;utter_greet&quot;</span><span class="p">)</span>

<span class="c1"># Send multiple messages</span>
<span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;First message&quot;</span><span class="p">)</span>
<span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Second message&quot;</span><span class="p">)</span>
</code></pre></div>

<h4>Tracker</h4>
<p>The <code>tracker</code> contains conversation information (we'll use this more in Level 3):</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Get conversation history (Level 3+)</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">events</span>

<span class="c1"># Get slots (Level 3+)</span>
<span class="n">account</span> <span class="o">=</span> <span class="n">tracker</span><span class="o">.</span><span class="n">get_slot</span><span class="p">(</span><span class="s2">&quot;account&quot;</span><span class="p">)</span>
</code></pre></div>

<p>For Level 2, we don't use the tracker much - it's mainly for Level 3 when we add memory.</p>
<h4>Domain</h4>
<p>The <code>domain</code> contains your bot's configuration:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Access domain (rarely needed)</span>
<span class="n">responses</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;responses&quot;</span><span class="p">,</span> <span class="p">{})</span>
</code></pre></div>

<p>For Level 2, you typically don't need to access the domain directly.</p>
<hr />
<h2>Module 3: Creating Your First Action</h2>
<h3>3.1 Step-by-Step: Creating an Action</h3>
<p>Let's create a simple action to practice. We'll create <code>action_bank_hours.py</code> (which already exists, but we'll understand how it was created).</p>
<h4>Before You Begin</h4>
<p>✅ <strong>Checklist</strong>:<br />
- You understand basic Python syntax<br />
- You know where the <code>actions/</code> folder is<br />
- You have a text editor ready<br />
- Your Level 1 bot is working</p>
<h4>Step-by-Step Tutorial</h4>
<p><strong>Step 1: Navigate to the Actions Folder</strong></p>
<ol>
<li>In your project folder, navigate to the <code>actions/</code> folder</li>
<li>If it doesn't exist, create it</li>
<li>You should see <code>__init__.py</code> (if the folder exists)</li>
</ol>
<p><strong>What you should see</strong>: An <code>actions/</code> folder with <code>__init__.py</code> inside.</p>
<hr />
<p><strong>Step 2: Create the Action File</strong></p>
<ol>
<li>In the <code>actions/</code> folder, create a new file named <code>action_bank_hours.py</code></li>
<li>Open it in your text editor</li>
</ol>
<p>⚠️ <strong>File naming</strong>:<br />
- Use lowercase with underscores: <code>action_bank_hours.py</code><br />
- Must start with <code>action_</code> (convention)<br />
- The filename should match the action name</p>
<hr />
<p><strong>Step 3: Add the Action Class Structure</strong></p>
<ol>
<li>Add the imports at the top:<br />
   ```python<br />
   from typing import Any, Dict, List, Text</li>
</ol>
<p>from rasa_sdk import Action, Tracker<br />
   from rasa_sdk.executor import CollectingDispatcher<br />
   ```</p>
<ol start="2">
<li>
<p>Create the class:<br />
   ```python<br />
   class ActionBankHours(Action):<br />
       def name(self) -&gt; Text:<br />
           return "action_bank_hours"</p>
<p>def run(self, dispatcher, tracker, domain):<br />
       dispatcher.utter_message(<br />
           text="Our bank hours are Monday-Friday 9am-5pm, Saturday 10am-2pm. We're closed on Sundays."<br />
       )<br />
       return []<br />
   ```</p>
</li>
</ol>
<p><strong>Complete file</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Text</span>

<span class="kn">from</span> <span class="nn">rasa_sdk</span> <span class="kn">import</span> <span class="n">Action</span><span class="p">,</span> <span class="n">Tracker</span>
<span class="kn">from</span> <span class="nn">rasa_sdk.executor</span> <span class="kn">import</span> <span class="n">CollectingDispatcher</span>


<span class="k">class</span> <span class="nc">ActionBankHours</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple custom action that returns bank hours.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Text</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;action_bank_hours&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dispatcher</span><span class="p">:</span> <span class="n">CollectingDispatcher</span><span class="p">,</span>
        <span class="n">tracker</span><span class="p">:</span> <span class="n">Tracker</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Text</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Text</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="n">dispatcher</span><span class="o">.</span><span class="n">utter_message</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Our bank hours are Monday-Friday 9am-5pm, Saturday 10am-2pm. We&#39;re closed on Sundays.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div>

<hr />
<p><strong>Step 4: Verify Your Code</strong></p>
<p>Before saving, check:</p>
<p>✅ <strong>Imports</strong>: All required imports are present<br />
✅ <strong>Class name</strong>: <code>ActionBankHours</code> (descriptive, starts with <code>Action</code>)<br />
✅ <strong><code>name()</code> method</strong>: Returns <code>"action_bank_hours"</code> (matches filename)<br />
✅ <strong><code>run()</code> method</strong>: Has correct parameters (<code>dispatcher</code>, <code>tracker</code>, <code>domain</code>)<br />
✅ <strong>Message sending</strong>: Uses <code>dispatcher.utter_message()</code><br />
✅ <strong>Return value</strong>: Returns <code>[]</code> (empty list)</p>
<p><strong>Common mistakes to avoid</strong>:<br />
- ❌ Forgetting to inherit from <code>Action</code><br />
- ❌ Wrong return type in <code>name()</code> (should return string, not call it)<br />
- ❌ Forgetting to return <code>[]</code> from <code>run()</code><br />
- ❌ Typos in method names (<code>run</code> not <code>runs</code>, <code>name</code> not <code>names</code>)</p>
<hr />
<p><strong>Step 5: Save the File</strong></p>
<ol>
<li>Save your file as <code>action_bank_hours.py</code> in the <code>actions/</code> folder</li>
<li>Your action is now created!</li>
</ol>
<hr />
<h3>3.2 Understanding Action Execution</h3>
<p>When Rasa executes your action:</p>
<ol>
<li><strong>Rasa finds the action</strong>: Looks for <code>action_bank_hours</code> in the <code>actions/</code> folder</li>
<li><strong>Rasa instantiates the class</strong>: Creates an instance of <code>ActionBankHours</code></li>
<li><strong>Rasa calls <code>name()</code></strong>: Verifies the action name matches</li>
<li><strong>Rasa calls <code>run()</code></strong>: Executes your custom code</li>
<li><strong>Your code runs</strong>: Python executes your logic</li>
<li><strong>Message is sent</strong>: <code>dispatcher.utter_message()</code> sends text to the user</li>
<li><strong>Action completes</strong>: Returns empty list <code>[]</code></li>
</ol>
<p><strong>Key Point</strong>: Rasa handles all the infrastructure - you just write the <code>run()</code> method with your logic.</p>
<hr />
<h2>Module 4: Registering Actions in the Domain</h2>
<h3>4.1 Why Register Actions?</h3>
<p>Actions must be registered in the domain file so Rasa knows they exist. Without registration, Rasa won't find your actions even if the Python files exist.</p>
<p><strong>File Location</strong>: <code>domain/basics.yml</code></p>
<p><strong>Analogy</strong>: Registering an action is like adding a phone number to your contacts - you need to tell Rasa "this action exists and here's its name."</p>
<hr />
<h3>4.2 The Actions Section</h3>
<p>In Level 1, your domain file only had a <code>responses:</code> section. Level 2 adds an <code>actions:</code> section.</p>
<h4>Domain Structure in Level 2</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.1&quot;</span>

<span class="nt">responses</span><span class="p">:</span><span class="w">              </span><span class="c1"># ← From Level 1 (unchanged)</span>
<span class="w">  </span><span class="nt">utter_greet</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hi!</span><span class="nv"> </span><span class="s">I&#39;m</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">banking</span><span class="nv"> </span><span class="s">assistant...&quot;</span>
<span class="w">  </span><span class="c1"># ... other responses</span>

<span class="nt">actions</span><span class="p">:</span><span class="w">                </span><span class="c1"># ← NEW in Level 2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span><span class="w">   </span><span class="c1"># ← Register your actions here</span>
</code></pre></div>

<h4>How to Register an Action</h4>
<ol>
<li><strong>Open <code>domain/basics.yml</code></strong></li>
<li>
<p><strong>Add <code>actions:</code> section</strong> (if it doesn't exist):<br />
   ```yaml<br />
   actions:</p>
<ul>
<li>action_bank_hours<br />
   ```</li>
</ul>
</li>
<li>
<p><strong>The action name must match</strong>:<br />
   - The return value of <code>name()</code> method: <code>"action_bank_hours"</code><br />
   - The class name (without <code>Action</code> prefix): <code>ActionBankHours</code> → <code>action_bank_hours</code><br />
   - Convention: lowercase with underscores</p>
</li>
</ol>
<hr />
<h3>4.3 Step-by-Step: Registering Your Action</h3>
<p><strong>Step 1: Open the Domain File</strong></p>
<ol>
<li>Navigate to <code>domain/basics.yml</code></li>
<li>Open it in your editor</li>
</ol>
<p><strong>What you should see</strong>: Your Level 1 responses (<code>utter_greet</code>, <code>utter_help</code>, <code>utter_contact</code>)</p>
<hr />
<p><strong>Step 2: Add the Actions Section</strong></p>
<ol>
<li>Find the end of the <code>responses:</code> section</li>
<li>Add a blank line</li>
<li>Add the <code>actions:</code> section:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nt">responses</span><span class="p">:</span>
<span class="w">  </span><span class="nt">utter_greet</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hi!</span><span class="nv"> </span><span class="s">I&#39;m</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">banking</span><span class="nv"> </span><span class="s">assistant.</span><span class="nv"> </span><span class="s">How</span><span class="nv"> </span><span class="s">can</span><span class="nv"> </span><span class="s">I</span><span class="nv"> </span><span class="s">help</span><span class="nv"> </span><span class="s">you</span><span class="nv"> </span><span class="s">today?&quot;</span>
<span class="w">      </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">        </span><span class="nt">rephrase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="w">  </span><span class="nt">utter_help</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">I can help you with:</span>
<span class="w">        </span><span class="no">- Checking your balance</span>
<span class="w">        </span><span class="no">- Transferring money</span>
<span class="w">        </span><span class="no">- Bank hours</span>
<span class="w">        </span><span class="no">- Contact information</span>
<span class="w">      </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">        </span><span class="nt">rephrase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="w">  </span><span class="nt">utter_contact</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;You</span><span class="nv"> </span><span class="s">can</span><span class="nv"> </span><span class="s">reach</span><span class="nv"> </span><span class="s">us</span><span class="nv"> </span><span class="s">at</span><span class="nv"> </span><span class="s">support@bank.com</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">call</span><span class="nv"> </span><span class="s">1-800-BANK-123.&quot;</span>
<span class="w">      </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">        </span><span class="nt">rephrase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>

<span class="nt">actions</span><span class="p">:</span><span class="w">                </span><span class="c1"># ← NEW: Add this section</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span><span class="w">   </span><span class="c1"># ← List your actions here</span>
</code></pre></div>

<p>⚠️ <strong>Important</strong>:<br />
- <code>actions:</code> is at the same indentation level as <code>responses:</code><br />
- The dash (<code>-</code>) indicates a list item<br />
- Action name must match exactly what <code>name()</code> returns</p>
<hr />
<p><strong>Step 3: Verify Registration</strong></p>
<p>Check:<br />
- ✅ <code>actions:</code> section exists<br />
- ✅ Action name matches <code>name()</code> return value exactly<br />
- ✅ Proper YAML syntax (indentation, dashes)<br />
- ✅ No typos in action name</p>
<p><strong>Common mistakes</strong>:<br />
- ❌ Wrong action name (e.g., <code>action_bank_hour</code> instead of <code>action_bank_hours</code>)<br />
- ❌ Missing dash before action name<br />
- ❌ Wrong indentation<br />
- ❌ Action name doesn't match <code>name()</code> method return value</p>
<hr />
<h3>4.4 Multiple Actions</h3>
<p>When you have multiple actions, list them all:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_check_balance</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_process_transfer</span>
</code></pre></div>

<p>Each action gets its own line with a dash.</p>
<hr />
<h2>Module 5: Using Actions in Flows</h2>
<h3>5.1 Actions vs. Responses in Flows</h3>
<p>In Level 1, flows used <code>utter_*</code> responses. In Level 2, flows can use <code>action_*</code> actions.</p>
<h4>Level 1 Flow (Response)</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">greet</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">say hello</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Greet the user when they start a conversation.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_greet</span><span class="w">  </span><span class="c1"># ← Uses a response</span>
</code></pre></div>

<h4>Level 2 Flow (Action)</h4>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hours</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bank hours</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tell the user when the bank is open.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span><span class="w">  </span><span class="c1"># ← Uses an action</span>
</code></pre></div>

<p><strong>Key Difference</strong>: <br />
- <code>utter_*</code> = Predefined text (response)<br />
- <code>action_*</code> = Custom Python code (action)</p>
<p>Both use <code>- action:</code> in the flow, but Rasa knows the difference based on the name.</p>
<hr />
<h3>5.2 Creating a Flow That Uses an Action</h3>
<p>Let's create the <code>hours.yml</code> flow that uses <code>action_bank_hours</code>.</p>
<h4>Step-by-Step Tutorial</h4>
<p><strong>Step 1: Navigate to Data Folder</strong></p>
<ol>
<li>Go to <code>data/basics/</code> folder</li>
<li>You should see your Level 1 flows: <code>greet.yml</code>, <code>help.yml</code>, <code>contact.yml</code></li>
</ol>
<hr />
<p><strong>Step 2: Create the Hours Flow</strong></p>
<ol>
<li>Create a new file: <code>data/basics/hours.yml</code></li>
<li>Add the flow structure:</li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hours</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bank hours</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tell the user when the bank is open.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span>
</code></pre></div>

<p><strong>Complete file</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hours</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bank hours</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tell the user when the bank is open.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span>
</code></pre></div>

<hr />
<p><strong>Step 3: Understanding the Flow</strong></p>
<ul>
<li><strong><code>hours:</code></strong> - Flow identifier</li>
<li><strong><code>name: bank hours</code></strong> - Human-readable name</li>
<li><strong><code>description:</code></strong> - Critical! The LLM uses this to match user messages</li>
<li><strong><code>steps:</code></strong> - List of steps to execute</li>
<li><strong><code>- action: action_bank_hours</code></strong> - Calls your custom action</li>
</ul>
<p><strong>What happens</strong>:<br />
1. User asks "What are your hours?"<br />
2. LLM matches to <code>hours</code> flow (based on description)<br />
3. Flow executes <code>action_bank_hours</code><br />
4. Action runs Python code<br />
5. Action sends message via <code>dispatcher.utter_message()</code><br />
6. User sees: "Our bank hours are Monday-Friday 9am-5pm..."</p>
<hr />
<p><strong>Step 4: Verify the Flow</strong></p>
<p>Check:<br />
- ✅ File is in <code>data/basics/</code> folder<br />
- ✅ Flow has <code>name:</code>, <code>description:</code>, and <code>steps:</code><br />
- ✅ Action name matches registered action exactly<br />
- ✅ YAML syntax is correct</p>
<hr />
<h3>5.3 Mixing Responses and Actions</h3>
<p>You can use both responses and actions in the same flow:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">flows</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hours_and_contact</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hours and contact</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tell the user bank hours and provide contact information.</span>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">action_bank_hours</span><span class="w">      </span><span class="c1"># ← Action (custom code)</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">utter_contact</span><span class="w">          </span><span class="c1"># ← Response (predefined text)</span>
</code></pre></div>

<p><strong>Execution order</strong>:<br />
1. First: Action executes (returns dynamic hours)<br />
2. Second: Response sends (static contact info)</p>
<hr />
<h2>Module 6: Training and Testing with Actions</h2>
<h3>6.1 Training with Actions</h3>
<p>Training with actions is the same as Level 1, but Rasa now also processes your action files.</p>
<h4>Training Command</h4>
<div class="codehilite"><pre><span></span><code><span class="c"># Make sure environment variables are loaded</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">load_env</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Train the bot</span>
<span class="n">python</span> <span class="n">-m</span> <span class="n">rasa</span> <span class="n">train</span>
</code></pre></div>

<h4>What Happens During Training</h4>
<p>When you run <code>rasa train</code>, Rasa:</p>
<ol>
<li>
<p><strong>Reads all flows</strong> from <code>data/</code> folder<br />
   - Finds <code>hours.yml</code> with <code>action_bank_hours</code><br />
   - Processes all Level 1 flows (unchanged)</p>
</li>
<li>
<p><strong>Reads the domain</strong> from <code>domain/</code> folder<br />
   - Loads all responses (from Level 1)<br />
   - Loads all actions (new in Level 2)<br />
   - Verifies registered actions exist</p>
</li>
<li>
<p><strong>Validates actions</strong>:<br />
   - Checks that <code>action_bank_hours</code> exists in <code>actions/</code> folder<br />
   - Verifies the <code>name()</code> method returns the registered name<br />
   - Ensures the action class is properly structured</p>
</li>
<li>
<p><strong>Creates model file</strong>:<br />
   - Saves everything to <code>models/</code> folder<br />
   - Includes action registration information</p>
</li>
</ol>
<hr />
<h3>6.2 Common Training Errors with Actions</h3>
<h4>Error: Action Not Found</h4>
<p><strong>What you'll see</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="n">Action</span><span class="w"> </span><span class="s1">&#39;action_bank_hours&#39;</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">found</span>
</code></pre></div>

<p><strong>What this means</strong>: Rasa can't find your action file.</p>
<p><strong>How to fix</strong>:<br />
1. Check the action file exists: <code>actions/action_bank_hours.py</code><br />
2. Check the action is registered: <code>domain/basics.yml</code> has <code>- action_bank_hours</code><br />
3. Check the <code>name()</code> method returns the correct name<br />
4. Verify the file is in the <code>actions/</code> folder (not <code>action/</code> or elsewhere)</p>
<hr />
<h4>Error: Import Error</h4>
<p><strong>What you'll see</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span> <span class="nn">name</span> <span class="s1">&#39;Action&#39;</span> <span class="kn">from</span> <span class="s1">&#39;rasa_sdk&#39;</span>
</code></pre></div>

<p><strong>What this means</strong>: Rasa SDK is not installed or wrong version.</p>
<p><strong>How to fix</strong>:<br />
1. Make sure Rasa Pro is installed: <code>python -m pip install rasa-pro</code><br />
2. Check your virtual environment is activated<br />
3. Verify Rasa SDK is included with Rasa Pro</p>
<hr />
<h4>Error: Name Mismatch</h4>
<p><strong>What you'll see</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Error</span><span class="o">:</span><span class="w"> </span><span class="n">Action</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="s1">&#39;action_bank_hours&#39;</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">doesn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="n">name</span>
</code></pre></div>

<p><strong>What this means</strong>: The action name in domain doesn't match what <code>name()</code> returns.</p>
<p><strong>How to fix</strong>:<br />
1. Check <code>domain/basics.yml</code>: Should have <code>- action_bank_hours</code><br />
2. Check <code>action_bank_hours.py</code>: <code>name()</code> should return <code>"action_bank_hours"</code><br />
3. Ensure they match exactly (case-sensitive!)</p>
<hr />
<h3>6.3 Testing Your Action</h3>
<h4>Basic Testing Workflow</h4>
<ol>
<li>
<p><strong>Train your bot</strong>: <code>python -m rasa train</code></p>
</li>
<li>
<p><strong>Start Inspector</strong>: <br />
<code>powershell
   python -m rasa inspect --debug --log-file logs/logs.out</code></p>
</li>
<li>
<p><strong>Test the action</strong>:<br />
   - Type "What are your hours?" or "When are you open?"<br />
   - Should trigger <code>hours</code> flow<br />
   - Should execute <code>action_bank_hours</code><br />
   - Should see: "Our bank hours are Monday-Friday 9am-5pm..."</p>
</li>
<li>
<p><strong>Verify Level 1 flows still work</strong>:<br />
   - Type "hello" → Should trigger <code>greet</code> flow (unchanged)<br />
   - Type "help" → Should trigger <code>help</code> flow (unchanged)<br />
   - Type "contact" → Should trigger <code>contact</code> flow (unchanged)</p>
</li>
</ol>
<p><strong>Key Point</strong>: All Level 1 functionality remains - Level 2 adds new capabilities without breaking existing ones.</p>
<hr />
<h3>6.4 Debugging Actions</h3>
<h4>Check Debug Output</h4>
<p>When testing in Inspector, check the debug panel:<br />
- Which flow was triggered?<br />
- Which action was called?<br />
- Did the action execute successfully?</p>
<h4>Common Issues</h4>
<ol>
<li>
<p><strong>Action doesn't trigger</strong>:<br />
   - Check flow description matches user intent<br />
   - Verify action is registered in domain<br />
   - Check action file exists and is correct</p>
</li>
<li>
<p><strong>Action executes but no message</strong>:<br />
   - Check <code>dispatcher.utter_message()</code> is called<br />
   - Verify the message text is correct<br />
   - Check for Python errors in the action</p>
</li>
<li>
<p><strong>Python errors in action</strong>:<br />
   - Check Python syntax<br />
   - Verify all imports are correct<br />
   - Check for typos in method names</p>
</li>
</ol>
<hr />
<h2>Module 7: Putting It All Together</h2>
<h3>7.1 Complete Bot Walkthrough</h3>
<p>Let's trace through a complete conversation showing how Level 1 and Level 2 work together.</p>
<h4>Conversation Example</h4>
<div class="codehilite"><pre><span></span><code><span class="k">[User opens chat - new session starts]</span>

<span class="na">1. pattern_session_start triggers automatically (Level 1)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow</span><span class="o">:</span><span class="w"> </span><span class="s">pattern_session_start</span>
<span class="w">   </span><span class="na">Step</span><span class="o">:</span><span class="w"> </span><span class="s">utter_greet</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Hi! I&#39;m a banking assistant. How can I help you today?&quot;</span>

<span class="k">[User types: &quot;What are your hours?&quot;]</span>

<span class="na">2. LLM understands</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;User wants to know bank hours&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">FlowPolicy matches to</span><span class="o">:</span><span class="w"> </span><span class="s">hours flow (Level 2)</span>
<span class="w">   </span><span class="na">(Description</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Tell the user when the bank is open&quot;)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow</span><span class="o">:</span><span class="w"> </span><span class="s">hours</span>
<span class="w">   </span><span class="na">Step</span><span class="o">:</span><span class="w"> </span><span class="s">action_bank_hours (Level 2 - custom Python code!)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Action executes Python code</span>
<span class="w">   </span><span class="na">dispatcher.utter_message() sends message</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;Our bank hours are Monday-Friday 9am-5pm, Saturday 10am-2pm. We&#39;re closed on Sundays.&quot;</span>

<span class="k">[User types: &quot;How can I contact you?&quot;]</span>

<span class="na">3. LLM understands</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;User wants contact information&quot;</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">FlowPolicy matches to</span><span class="o">:</span><span class="w"> </span><span class="s">contact flow (Level 1)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="w">   </span><span class="na">Flow</span><span class="o">:</span><span class="w"> </span><span class="s">contact</span>
<span class="w">   </span><span class="na">Step</span><span class="o">:</span><span class="w"> </span><span class="s">utter_contact (Level 1 - static response)</span>
<span class="w">   </span><span class="na">↓</span>
<span class="na">Bot</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;You can reach us at support@bank.com or call 1-800-BANK-123.&quot;</span>
</code></pre></div>

<p><strong>Notice</strong>: The bot seamlessly uses both Level 1 responses and Level 2 actions!</p>
<hr />
<h3>7.2 Your Level 2 Banking Bot: Summary</h3>
<p>Congratulations! You've extended your Level 1 banking bot with custom Python code.</p>
<h4>Your Complete Bot Structure</h4>
<p><strong>Domain (<code>domain/basics.yml</code>)</strong>:<br />
- ✅ All Level 1 responses (<code>utter_greet</code>, <code>utter_help</code>, <code>utter_contact</code>)<br />
- ✅ New <code>actions:</code> section with <code>action_bank_hours</code></p>
<p><strong>Flows (<code>data/basics/</code>)</strong>:<br />
- ✅ All Level 1 flows (<code>greet</code>, <code>help</code>, <code>contact</code>)<br />
- ✅ New flow (<code>hours</code>) that uses an action</p>
<p><strong>Actions (<code>actions/</code>)</strong>:<br />
- ✅ <code>action_bank_hours.py</code> - Returns bank hours dynamically</p>
<p><strong>System Patterns</strong>: Unchanged from Level 1</p>
<p><strong>Configuration</strong>: Unchanged from Level 1 (except minor endpoints.yml updates)</p>
<h4>What Your Bot Can Do Now</h4>
<p>Your Level 2 banking bot can:<br />
- ✅ Everything Level 1 could do (greet, help, contact)<br />
- ✅ Execute custom Python code (actions)<br />
- ✅ Return dynamic responses based on code execution<br />
- ✅ Process data and perform calculations</p>
<h4>What's Still Missing (Coming in Future Levels)</h4>
<p>Your Level 2 bot cannot yet:<br />
- ❌ Remember information from the conversation (Level 3: Slots)<br />
- ❌ Collect multiple pieces of information (Level 4: Multiple Slots)<br />
- ❌ Use dynamic tool calling (Level 5: Tools)</p>
<p>But you have a solid foundation with custom code capabilities!</p>
<hr />
<h3>7.3 Best Practices</h3>
<h4>Organizing Actions</h4>
<ol>
<li><strong>One action per file</strong>: Makes it easier to find and modify actions</li>
<li><strong>Descriptive names</strong>: Use clear, descriptive action names</li>
<li><strong>Group related actions</strong>: Keep related actions in the same folder</li>
</ol>
<h4>Writing Good Actions</h4>
<ol>
<li><strong>Keep actions focused</strong>: Each action should do one thing well</li>
<li><strong>Handle errors gracefully</strong>: Check for None values, validate input</li>
<li><strong>Use clear messages</strong>: Make sure users understand what happened</li>
<li><strong>Add comments</strong>: Explain complex logic</li>
</ol>
<h4>Action Naming Conventions</h4>
<ul>
<li>✅ <strong>Good</strong>: <code>action_bank_hours</code>, <code>action_check_balance</code>, <code>action_process_transfer</code></li>
<li>❌ <strong>Bad</strong>: <code>action1</code>, <code>hours</code>, <code>do_stuff</code></li>
</ul>
<p><strong>Convention</strong>: <code>action_</code> + descriptive_name (lowercase, underscores)</p>
<hr />
<h2>Module 8: Assessment and Next Steps</h2>
<h3>8.1 Knowledge Check</h3>
<p>Test your understanding with these questions:</p>
<h4>Question 1: What is an Action?</h4>
<p>a) A predefined bot message<br />
b) Custom Python code the bot can execute<br />
c) A conversation script<br />
d) A configuration file</p>
<p><strong>Answer</strong>: b) Custom Python code the bot can execute</p>
<p><strong>Explanation</strong>: Actions are Python classes that execute custom code. They allow the bot to do more than just send static text - they can perform calculations, access databases, and execute any Python logic.</p>
<hr />
<h4>Question 2: Where are Actions Defined?</h4>
<p>a) In <code>domain/basics.yml</code> under <code>responses:</code><br />
b) In Python files in the <code>actions/</code> folder<br />
c) In flow files in <code>data/basics/</code><br />
d) In <code>config.yml</code></p>
<p><strong>Answer</strong>: b) In Python files in the <code>actions/</code> folder</p>
<p><strong>Explanation</strong>: Actions are Python classes defined in <code>.py</code> files in the <code>actions/</code> folder. They must also be registered in <code>domain/basics.yml</code> under <code>actions:</code>, but the actual code is in Python files.</p>
<hr />
<h4>Question 3: What Method Must Every Action Have?</h4>
<p>a) <code>execute()</code><br />
b) <code>run()</code><br />
c) <code>perform()</code><br />
d) <code>do()</code></p>
<p><strong>Answer</strong>: b) <code>run()</code></p>
<p><strong>Explanation</strong>: Every action class must have a <code>run()</code> method that contains the custom logic. This is the method Rasa calls when the action is executed.</p>
<hr />
<h4>Question 4: How Do You Send a Message from an Action?</h4>
<p>a) <code>print("message")</code><br />
b) <code>dispatcher.utter_message(text="message")</code><br />
c) <code>return "message"</code><br />
d) <code>send_message("message")</code></p>
<p><strong>Answer</strong>: b) <code>dispatcher.utter_message(text="message")</code></p>
<p><strong>Explanation</strong>: The <code>dispatcher</code> parameter in the <code>run()</code> method is used to send messages to the user. Use <code>dispatcher.utter_message(text="...")</code> to send text.</p>
<hr />
<h4>Question 5: What's the Difference Between <code>utter_*</code> and <code>action_*</code>?</h4>
<p>a) There's no difference<br />
b) <code>utter_*</code> are responses (static text), <code>action_*</code> are actions (custom code)<br />
c) <code>utter_*</code> are actions, <code>action_*</code> are responses<br />
d) They're the same thing</p>
<p><strong>Answer</strong>: b) <code>utter_*</code> are responses (static text), <code>action_*</code> are actions (custom code)</p>
<p><strong>Explanation</strong>: <code>utter_*</code> responses are predefined text messages in the domain file. <code>action_*</code> actions are custom Python code that can execute any logic. Both can be called from flows using <code>- action:</code>, but they work differently.</p>
<hr />
<h3>8.2 What You've Learned</h3>
<h4>Key Concepts</h4>
<ol>
<li><strong>Actions</strong>: Custom Python code that the bot can execute</li>
<li><strong>Action Class</strong>: Python class that inherits from <code>Action</code></li>
<li><strong>Action Registration</strong>: Telling Rasa about actions in the domain file</li>
<li><strong>Dispatcher</strong>: Used to send messages from actions</li>
<li><strong>Action Execution</strong>: How Rasa calls and runs your custom code</li>
</ol>
<h4>Skills You've Developed</h4>
<ul>
<li>✅ Can create custom Python actions</li>
<li>✅ Can register actions in the domain file</li>
<li>✅ Can call actions from flows</li>
<li>✅ Can understand the difference between responses and actions</li>
<li>✅ Can debug action-related issues</li>
<li>✅ Can extend your Level 1 bot with custom code</li>
</ul>
<hr />
<h3>8.3 Limitations of Level 2</h3>
<p>Level 2 bots have clear limitations:</p>
<h4>What Level 2 Cannot Do</h4>
<ol>
<li>
<p><strong>Remember Information</strong>: The bot cannot remember what the user said earlier<br />
   - Example: User says "My account is 1234" → Bot forgets immediately<br />
   - Solution: Level 3 adds slots (memory)</p>
</li>
<li>
<p><strong>Use Previous Context</strong>: Actions can't access conversation history effectively<br />
   - Example: "Check my balance" → Bot doesn't know which account<br />
   - Solution: Level 3 adds slots to remember account numbers</p>
</li>
<li>
<p><strong>Collect Multiple Pieces of Information</strong>: Can't gather multiple data points<br />
   - Example: "Transfer money" → Bot can't collect amount, recipient, and account<br />
   - Solution: Level 4 adds multiple slot collection</p>
</li>
</ol>
<h4>When Level 2 is Sufficient</h4>
<p>Level 2 is perfect for:<br />
- ✅ Dynamic responses based on calculations<br />
- ✅ Data processing and formatting<br />
- ✅ Simple integrations (APIs, databases)<br />
- ✅ Conditional logic that doesn't need memory</p>
<h4>When You Need More</h4>
<p>Move to Level 3 when you need:<br />
- Memory (slots) to remember user information<br />
- Multi-turn conversations with context<br />
- Collecting information from users</p>
<hr />
<h3>8.4 What's Next: Level 3 Preview</h3>
<p>⚠️ <strong>Important: Building on Your Existing Banking Bot</strong></p>
<p>When you move to Level 3, you will <strong>continue working on the same banking bot</strong> you've built throughout Levels 1 and 2. Level 3 doesn't start from scratch - it builds on what you've already created:</p>
<ul>
<li><strong>Your existing responses</strong> (<code>utter_greet</code>, <code>utter_help</code>, <code>utter_contact</code>) stay</li>
<li><strong>Your existing flows</strong> (<code>greet</code>, <code>help</code>, <code>contact</code>, <code>hours</code>) stay</li>
<li><strong>Your existing actions</strong> (<code>action_bank_hours</code>) stay</li>
<li><strong>Level 3 adds</strong>: Slots (memory), new responses for asking questions, new actions that use slots, new flows that collect information</li>
</ul>
<p><strong>You don't start a new bot</strong> - you extend your existing Level 2 banking bot with memory capabilities!</p>
<hr />
<p><strong>Level 3: Slot Collection</strong> introduces conversation memory.</p>
<h4>What Slots Enable</h4>
<p><strong>Example Scenario</strong>: "Check my balance"</p>
<ul>
<li><strong>Level 2</strong>: Bot can't remember which account the user has</li>
<li><strong>Level 3</strong>: Bot can:</li>
<li>Ask for account number</li>
<li>Remember it in a slot</li>
<li>Use that slot in actions</li>
<li>Check balance for that specific account</li>
</ul>
<p>In Level 3, you'll add:<br />
- <code>account</code> slot to store the user's account number<br />
- <code>utter_ask_account</code> response to ask for the account<br />
- <code>action_check_balance_simple</code> action that reads the slot<br />
- <code>check_balance</code> flow that collects the account before checking</p>
<h4>Key Concepts in Level 3</h4>
<ol>
<li><strong>Slots</strong>: Memory variables that store information from the conversation</li>
<li><strong>Slot Collection</strong>: Using <code>collect:</code> in flows to ask for and store information</li>
<li><strong>Reading Slots</strong>: Using <code>tracker.get_slot()</code> in actions to access stored information</li>
<li><strong>Ask Responses</strong>: <code>utter_ask_*</code> responses used when collecting slots</li>
</ol>
<h4>When to Move to Level 3</h4>
<p>Move to Level 3 when you need:<br />
- To remember information from the conversation<br />
- To collect information from users before performing actions<br />
- Multi-turn conversations with context<br />
- Personalized responses based on user information</p>
<p><strong>Your Level 2 banking bot is the foundation</strong> - Level 3 adds memory on top of it!</p>
<hr />
<h3>8.5 Course Completion Checklist</h3>
<p>Before moving to Level 3, ensure you can:</p>
<ul>
<li>[ ] Explain what an action is and how it differs from a response</li>
<li>[ ] Create a new action in Python</li>
<li>[ ] Register an action in the domain file</li>
<li>[ ] Create a flow that uses an action</li>
<li>[ ] Understand how actions are executed</li>
<li>[ ] Debug when actions don't work</li>
<li>[ ] Understand that Level 2 builds on Level 1 (all Level 1 content remains)</li>
</ul>
<p>If you can check all these boxes, you're ready for Level 3!</p>
<hr />
<h2>Troubleshooting Guide</h2>
<h3>Common Issues and Solutions</h3>
<h4>Issue: Action Not Found Error</h4>
<p><strong>Symptoms</strong>: Training error: "Action 'action_xyz' not found"</p>
<p><strong>Possible Causes</strong>:<br />
1. Action file doesn't exist in <code>actions/</code> folder<br />
2. Action not registered in domain<br />
3. Action name mismatch (domain vs. <code>name()</code> method)</p>
<p><strong>Solutions</strong>:<br />
1. Check <code>actions/action_xyz.py</code> exists<br />
2. Verify <code>domain/basics.yml</code> has <code>- action_xyz</code> under <code>actions:</code><br />
3. Ensure <code>name()</code> returns exactly <code>"action_xyz"</code> (case-sensitive)</p>
<hr />
<h4>Issue: Action Executes But No Message</h4>
<p><strong>Symptoms</strong>: Action runs but user doesn't see a message</p>
<p><strong>Possible Causes</strong>:<br />
1. <code>dispatcher.utter_message()</code> not called<br />
2. Python error in action (silent failure)<br />
3. Wrong dispatcher usage</p>
<p><strong>Solutions</strong>:<br />
1. Check <code>dispatcher.utter_message()</code> is called in <code>run()</code> method<br />
2. Check for Python errors (syntax, imports)<br />
3. Verify you're using <code>dispatcher.utter_message(text="...")</code> correctly</p>
<hr />
<h4>Issue: Import Error</h4>
<p><strong>Symptoms</strong>: <code>ImportError: cannot import name 'Action'</code></p>
<p><strong>Possible Causes</strong>:<br />
1. Rasa SDK not installed<br />
2. Wrong virtual environment<br />
3. Rasa Pro not properly installed</p>
<p><strong>Solutions</strong>:<br />
1. Install Rasa Pro: <code>python -m pip install rasa-pro</code><br />
2. Activate correct virtual environment<br />
3. Verify installation: <code>python -m rasa --version</code></p>
<hr />
<h2>Additional Resources</h2>
<h3>Extension Exercises</h3>
<h4>Exercise 1: Add More Actions</h4>
<p><strong>Task</strong>: Create additional actions for your banking bot:<br />
- <code>action_account_types.py</code> - Returns information about account types<br />
- <code>action_loan_info.py</code> - Returns loan information</p>
<p><strong>Goal</strong>: Practice creating multiple actions and registering them.</p>
<hr />
<h4>Exercise 2: Dynamic Responses</h4>
<p><strong>Task</strong>: Modify <code>action_bank_hours.py</code> to:<br />
- Check the current day of week<br />
- Return different messages based on whether bank is currently open</p>
<p><strong>Goal</strong>: Learn to use Python logic in actions.</p>
<hr />
<h4>Exercise 3: Action with Calculations</h4>
<p><strong>Task</strong>: Create <code>action_calculate_interest.py</code> that:<br />
- Takes a principal amount and interest rate<br />
- Calculates simple interest<br />
- Returns the result</p>
<p><strong>Goal</strong>: Practice using Python calculations in actions.</p>
<hr />
<h2>Conclusion</h2>
<p>Congratulations! You've completed Level 2 and learned how to add custom Python code to your Rasa bot.</p>
<h3>What You Can Do Now</h3>
<ul>
<li>Add custom Python code to your bot</li>
<li>Create dynamic responses based on logic</li>
<li>Process data and perform calculations</li>
<li>Integrate with external systems (with proper setup)</li>
<li>Extend your Level 1 bot with new capabilities</li>
</ul>
<h3>What's Coming Next</h3>
<ul>
<li><strong>Level 3</strong>: Add memory (slots) so the bot can remember information</li>
<li><strong>Level 4</strong>: Collect multiple pieces of information</li>
<li><strong>Level 5</strong>: Enable dynamic tool calling</li>
</ul>
<h3>Keep Learning</h3>
<ul>
<li>Practice by creating more actions</li>
<li>Experiment with different Python logic</li>
<li>Try integrating with simple APIs</li>
<li>Read the Rasa SDK documentation</li>
<li>Join the Rasa community</li>
</ul>
<p><strong>Happy coding! 🚀</strong></p>
    </article>
</body>
</html>